/* Da chinh sua hoan chinh */
USE master
Drop Database DB_QLHOCSINH_THPT;
USE master
CREATE DATABASE DB_QLHOCSINH_THPT
USE DB_QLHOCSINH_THPT
GO
--===================================================================================================================================================
/* OK */
CREATE TABLE HOCLUC
(
	MAHOCLUC		VARCHAR (10)	NOT NULL,
	TENHOCLUC		NVARCHAR (30)	NOT NULL,
	DIEMCANDUOI		FLOAT			NOT NULL,
	DIEMCANTREN		FLOAT			NOT NULL,
	DIEMKHONGCHE	FLOAT			NOT NULL,
	CONSTRAINT PK_HOCLUC PRIMARY KEY(MAHOCLUC)
)
INSERT INTO HOCLUC VALUES('HL01',N'Giỏi',	8.0,	10.0,	6.5)
INSERT INTO HOCLUC VALUES('HL02',N'Khá',	6.5,	7.9,	5.0)
INSERT INTO HOCLUC VALUES('HL03',N'TB',		5.0,	6.4,	3.5)
INSERT INTO HOCLUC VALUES('HL04',N'Yếu',	3.5,	4.9,	2.0)
INSERT INTO HOCLUC VALUES('HL05',N'Kém',	0.0,	3.4,	0.0)
-----------------------------------------------------------------------------------------------------------------------------------------------------
/* OK */
CREATE TABLE HANHKIEM
(
	MAHANHKIEM		VARCHAR (10)	NOT NULL,
	TENHANHKIEM		NVARCHAR (30)	NOT NULL,
	CONSTRAINT PK_HANHKIEM PRIMARY KEY(MAHANHKIEM)
)
INSERT INTO HANHKIEM VALUES('HK01',N'Tốt')
INSERT INTO HANHKIEM VALUES('HK02',N'Khá')
INSERT INTO HANHKIEM VALUES('HK03',N'TB')
INSERT INTO HANHKIEM VALUES('HK04',N'Yếu')
-----------------------------------------------------------------------------------------------------------------------------------------------------
/* OK */
CREATE TABLE KETQUA
(
	MAKETQUA	VARCHAR (10)	NOT NULL,
	TENKETQUA	NVARCHAR (30)	NOT NULL,
	CONSTRAINT PK_KETQUA PRIMARY KEY(MAKETQUA)
)
INSERT INTO KETQUA VALUES('KQ01',N'Lên lớp')
INSERT INTO KETQUA VALUES('KQ02',N'Thi lại')
INSERT INTO KETQUA VALUES('KQ03',N'Rèn luyện hè')
INSERT INTO KETQUA VALUES('KQ04',N'Ở lại Lớp')
--===================================================================================================================================================
/* OK */
CREATE TABLE QUYDINH
(
	KHOA		VARCHAR(20)		NOT NULL,
	GIATRI		NVARCHAR(250)	NOT NULL,
	CONSTRAINT PK_QUYDINH PRIMARY KEY(KHOA)
)
INSERT INTO QUYDINH VALUES('DiaChiTruong',N'Quận Bình Thạnh')
INSERT INTO QUYDINH VALUES('MaNamHocHT','NH1415')
INSERT INTO QUYDINH VALUES('NgayApDung','15-08-2014')
INSERT INTO QUYDINH VALUES('SiSoCanTren','45')
INSERT INTO QUYDINH VALUES('SiSoCanDuoi','25')
INSERT INTO QUYDINH VALUES('TenTruong',N'Võ Thị Sáu')
INSERT INTO QUYDINH VALUES('TuoiCanTren','19')
INSERT INTO QUYDINH VALUES('TuoiCanDuoi','15')
-----------------------------------------------------------------------------------------------------------------------------------------------------
--- OK ---
CREATE TABLE LOAINGUOIDUNG
(
	MALOAIND	VARCHAR(10)		NOT NULL,
	TENLOAIND	NVARCHAR(50)	NOT NULL,
	CONSTRAINT PK_LOAINGUOIDUNG PRIMARY KEY(MALOAIND)
)
INSERT INTO LOAINGUOIDUNG VALUES('quantri',N'Quản trị viên')
INSERT INTO LOAINGUOIDUNG VALUES('giaovu',N'Giáo vụ')
INSERT INTO LOAINGUOIDUNG VALUES('giaovien',N'Giáo viên')
INSERT INTO LOAINGUOIDUNG VALUES('hieutruong',N'Hiệu trưởng')
-----------------------------------------------------------------------------------------------------------------------------------------------------
--- OK
CREATE TABLE  NGUOIDUNG
(
	MANGUOIDUNG VARCHAR (10) 	NOT NULL,
	MALOAIND	VARCHAR(10)		NOT NULL,
	TENDANGNHAP	VARCHAR (30)	NOT NULL,
	MATKHAU		VARCHAR (30)	NOT NULL,
	CONSTRAINT PK_NGUOIDUNG_LOAINGUOIDUNG PRIMARY KEY(MANGUOIDUNG),
)
INSERT INTO NGUOIDUNG VALUES('ND01','quantri','admin','admin')
INSERT INTO NGUOIDUNG VALUES('ND02','hieutruong','bangiamhieu','bangiamhieu')
INSERT INTO NGUOIDUNG VALUES('ND03','giaovu','giaovu','giaovu')
INSERT INTO NGUOIDUNG VALUES('ND04','giaovien','giaovien','giaovien')
--===================================================================================================================================================
/* OK */
CREATE TABLE NAMHOC
(
	MANAMHOC	VARCHAR (10)	NOT NULL,
	TENNAMHOC	NVARCHAR (30)	NOT NULL,
	CONSTRAINT PK_NAMHOC PRIMARY KEY(MANAMHOC)
)
INSERT INTO NAMHOC VALUES('NH1415','2014 - 2015')
INSERT INTO NAMHOC VALUES('NH1516','2015 - 2016')
-----------------------------------------------------------------------------------------------------------------------------------------------------
/* OK */
CREATE TABLE HOCKY
(
	MAHOCKY		VARCHAR (10)	NOT NULL,
	TENHOCKY	NVARCHAR (30)	NOT NULL,
	HESO		INT,
	CONSTRAINT PK_HOCKY PRIMARY KEY(MAHOCKY)
)
INSERT INTO HOCKY VALUES('HK1',N'Học kỳ 1',1)
INSERT INTO HOCKY VALUES('HK2',N'Học kỳ 2',2)
--===================================================================================================================================================
/* OK */
CREATE TABLE KHOILOP
(
	MAKHOI		VARCHAR (10)	NOT NULL,
	TENKHOILOP	NVARCHAR (30)	NOT NULL,
	CONSTRAINT PK_KHOILOP PRIMARY KEY(MAKHOI)
)
INSERT INTO KHOILOP VALUES('K10',N'Khối 10')
INSERT INTO KHOILOP VALUES('K11',N'Khối 11')
INSERT INTO KHOILOP VALUES('K12',N'Khối 12')
-----------------------------------------------------------------------------------------------------------------------------------------------------
/* OK */
CREATE TABLE GIOITINH
(
	MAGIOITINH INT IDENTITY(1,1) PRIMARY KEY,
	TENGIOITINH NVARCHAR(5)
)
INSERT INTO GIOITINH(TENGIOITINH) VALUES('Nam')
INSERT INTO GIOITINH(TENGIOITINH) VALUES(N'Nữ')
-----------------------------------------------------------------------------------------------------------------------------------------------------
/* OK */
CREATE TABLE MONHOC
(
	MAMONHOC	VARCHAR (10)	NOT NULL,
	TENMONHOC	NVARCHAR (30)	NOT NULL,
	SOTIET		INT				NOT NULL,
	HESO		INT				NOT NULL,
	CONSTRAINT PK_MONHOC PRIMARY KEY(MAMONHOC)
)
INSERT INTO MONHOC VALUES('MH01',N'Toán Học',	90,	2)
INSERT INTO MONHOC VALUES('MH02',N'Vật Lý',		60,	1)
INSERT INTO MONHOC VALUES('MH03',N'Hóa Học',	60,	1)
INSERT INTO MONHOC VALUES('MH04',N'Sinh Học',	60,	1)
INSERT INTO MONHOC VALUES('MH05',N'Ngữ Văn',	90,	2)
INSERT INTO MONHOC VALUES('MH06',N'Lịch Sử',	45,	1)
INSERT INTO MONHOC VALUES('MH07',N'Địa Lý',		45,	1)
INSERT INTO MONHOC VALUES('MH08',N'Anh Văn',	45,	1)
INSERT INTO MONHOC VALUES('MH09',N'GD Công Dân',30,	1)
INSERT INTO MONHOC VALUES('MH10',N'Tin Học',	30,	1)
INSERT INTO MONHOC VALUES('MH11',N'Thể Dục',	30,	1)
INSERT INTO MONHOC VALUES('MH12',N'Quốc Phòng',	30,	1)
INSERT INTO MONHOC VALUES('MH13',N'Công Nghệ',	30,	1)

-----------------------------------------------------------------------------------------------------------------------------------------------------
/* OK */
CREATE TABLE GIAOVIEN
(
	MAGIAOVIEN	VARCHAR (10)	NOT NULL,
	TENGIAOVIEN NVARCHAR (30)	NOT NULL,
	MAGIOITINH	INT				NOT NULL,
	DIACHI		NVARCHAR (50)	NOT NULL,
	DIENTHOAI	VARCHAR (11)	NOT NULL,
	MAMONHOC	VARCHAR (10)	NOT NULL,
	CONSTRAINT PK_GIAOVIEN PRIMARY KEY(MAGIAOVIEN),
	-- (2 khoa ngoai)
	CONSTRAINT F_GV_MH FOREIGN KEY(MAMONHOC)	REFERENCES MONHOC(MAMONHOC),
	CONSTRAINT F_GV_GT FOREIGN KEY(MAGIOITINH)	REFERENCES GIOITINH(MAGIOITINH),
)
INSERT INTO GIAOVIEN VALUES('GVTO01',N'Nguyễn Hồng Phú',1,'140 LTT','0123456789','MH01')
INSERT INTO GIAOVIEN VALUES('GVTO02',N'Nguyễn Văn Đại',1,'140 LTT','0123456789','MH01')
INSERT INTO GIAOVIEN VALUES('GVVL01',N'Nguyễn Duy Hà',1,'140 LTT','0123456789','MH02')
INSERT INTO GIAOVIEN VALUES('GVVL02',N'Nguyễn Thị Mỷ Diện',2,'140 LTT','0123456789','MH02')
INSERT INTO GIAOVIEN VALUES('GVHH01',N'Nguyễn Ngọc Anh Thư',2,'140 LTT','0123456789','MH03')
INSERT INTO GIAOVIEN VALUES('GVHH02',N'Nguyễn Văn Đại',1,'140 LTT','0123456789','MH03')
INSERT INTO GIAOVIEN VALUES('GVSH01',N'Trần Thanh Huy',1,'140 LTT','0123456789','MH04')
INSERT INTO GIAOVIEN VALUES('GVSH02',N'Huỳnh Yến Nhi',2,'140 LTT','0123456789','MH04')
INSERT INTO GIAOVIEN VALUES('GVNV01',N'Nguyễn Thị Hoàng Oanh',2,'140 LTT','0123456789','MH05')
INSERT INTO GIAOVIEN VALUES('GVNV02',N'Huỳnh Yến Linh',2,'140 LTT','0123456789','MH05')
INSERT INTO GIAOVIEN VALUES('GVLS01',N'Nguyễn Hoàng Nam',1,'140 LTT','0123456789','MH06')
INSERT INTO GIAOVIEN VALUES('GVLS02',N'Nguyễn Hoàng Bắc',1,'140 LTT','0123456789','MH06')
--===================================================================================================================================================
/* OK */
CREATE TABLE LOP
(
	MALOP				VARCHAR (10)	NOT NULL,
	TENLOP				NVARCHAR(30)	NOT NULL,
	MAKHOI				VARCHAR (10)	NOT NULL,
	MANAMHOC			VARCHAR (10)	NOT NULL,
	SISO				INT 			NOT NULL,
	MAGIAOVIENCHUNHIEM	VARCHAR (10)	NOT NULL,
	CONSTRAINT PK_LOP PRIMARY KEY(MALOP),
	-- (3 khoa ngoai)
	CONSTRAINT F_LOP_KHOILOP FOREIGN KEY(MAKHOI)	REFERENCES KHOILOP(MAKHOI),
	CONSTRAINT F_LOP_NAMHOC FOREIGN KEY(MANAMHOC)	REFERENCES NAMHOC(MANAMHOC),
	CONSTRAINT F_LOP_GIAOVIEN FOREIGN KEY(MAGIAOVIENCHUNHIEM)	REFERENCES GIAOVIEN(MAGIAOVIEN)
)
INSERT INTO LOP VALUES('14151001','10A1','K10','NH1415',40,'GVTO01')
INSERT INTO LOP VALUES('14151002','10A2','K10','NH1415',40,'GVVL01')
INSERT INTO LOP VALUES('14151101','11A1','K11','NH1415',40,'GVVL02')
INSERT INTO LOP VALUES('14151102','11A2','K11','NH1415',40,'GVSH02')
INSERT INTO LOP VALUES('14151201','12A1','K12','NH1415',40,'GVLS01')
INSERT INTO LOP VALUES('14151202','12A2','K12','NH1415',40,'GVHH02')
INSERT INTO LOP VALUES('15161001','10A1','K10','NH1516',40,'GVSH01')
--===================================================================================================================================================
/* OK */
CREATE TABLE DANTOC
(
	MADANTOC	VARCHAR (10)    NOT NULL,
	TENDANTOC	NVARCHAR (30)	NOT NULL,
	CONSTRAINT PK_DANTOC PRIMARY KEY(MADANTOC)
)
INSERT INTO DANTOC VALUES('DT01',N'Kinh')
INSERT INTO DANTOC VALUES('DT02',N'Tày')
INSERT INTO DANTOC VALUES('DT03',N'Thái')
INSERT INTO DANTOC VALUES('DT04',N'Mường')
INSERT INTO DANTOC VALUES('DT05',N'Khơ me')
INSERT INTO DANTOC VALUES('DT06',N'HMông')
INSERT INTO DANTOC VALUES('DT07',N'Nùng')
INSERT INTO DANTOC VALUES('DT08',N'Hoa')
INSERT INTO DANTOC VALUES('DT09',N'Dao')
INSERT INTO DANTOC VALUES('DT10',N'Gia Rai')
-----------------------------------------------------------------------------------------------------------------------------------------------------
/* OK */
CREATE TABLE TONGIAO
(
	MATONGIAO	VARCHAR (10)	NOT NULL,
	TENTONGIAO	NVARCHAR (30)	NOT NULL,
	CONSTRAINT PK_TONGIAO PRIMARY KEY(MATONGIAO)
)
INSERT INTO TONGIAO VALUES('TG01',N'Không')
INSERT INTO TONGIAO VALUES('TG02',N'Phật')
INSERT INTO TONGIAO VALUES('TG03',N'Thiên chúa')
INSERT INTO TONGIAO VALUES('TG04',N'Cao đài')
-----------------------------------------------------------------------------------------------------------------------------------------------------
CREATE TABLE DOITUONG
(
	MADOITUONG		VARCHAR(10)		NOT NULL,
	TENDOITUONG		NVARCHAR(20)	NOT NULL,
	GHICHU			NVARCHAR(30)	,
	CONSTRAINT PK_DOITUONG PRIMARY KEY(MADOITUONG)
)
INSERT INTO DOITUONG VALUES('DTG01',N'Đối tượng 01','')
INSERT INTO DOITUONG VALUES('DTG02',N'Đối tượng 02','')
INSERT INTO DOITUONG VALUES('DTG03',N'Đối tượng 03','')
INSERT INTO DOITUONG VALUES('DTG04',N'Đối tượng 04','')
INSERT INTO DOITUONG VALUES('DTG05',N'Đối tượng 05','')
INSERT INTO DOITUONG VALUES('DTG06',N'Đối tượng 06','')
INSERT INTO DOITUONG VALUES('DTG07',N'Đối tượng 07','')
--===================================================================================================================================================
/* OK */
CREATE TABLE PHUHUYNH
(
	MAPHUHUYNH			VARCHAR(10)		NOT NULL,
	HOTENPHUHUYNH		NVARCHAR(30)	NOT NULL,
	MAGIOITINH			INT				NOT NULL,
	SDT					VARCHAR(11)		NOT NULL,
	DIACHI				NVARCHAR(100)	NOT NULL,
	CONSTRAINT PK_PHUHUYNH PRIMARY KEY(MAPHUHUYNH),
	---- ( 1 khoa ngoai)
	CONSTRAINT F_PH_GT FOREIGN KEY(MAGIOITINH)	REFERENCES GIOITINH(MAGIOITINH)
)
INSERT INTO PHUHUYNH VALUES('PH01',N'Nguyễn Văn Tèo',1,'01234567893','BT')
INSERT INTO PHUHUYNH VALUES('PH02',N'Nguyễn Văn Tình',1,'01234567893','BT')
INSERT INTO PHUHUYNH VALUES('PH03',N'Phạm Thị C',2,'01234567893','BT')
INSERT INTO PHUHUYNH VALUES('PH04',N'Nguyễn Văn Phúc',1,'01234567893','BT')
-----------------------------------------------------------------------------------------------------------------------------------------------------
/* OK */
CREATE TABLE HOCSINH
(
	MAHOCSINH		VARCHAR (10)	NOT NULL,
	HOTENHOCSINH	NVARCHAR(30)	NOT NULL,
	MAGIOITINH		INT				NOT NULL,
	NGAYSINH		DATE			NOT NULL,
	NOISINH			NVARCHAR(50)	NOT NULL,
	MADANTOC		VARCHAR(10)		NOT NULL,
	MATONGIAO		VARCHAR(10)		NOT NULL,
	MADOITUONG		VARCHAR(10)		NOT NULL,
	MAPHUHUYNH		VARCHAR(10)		NOT NULL,
	CONSTRAINT PK_HOCSINH PRIMARY KEY(MAHOCSINH),
	-- (6 khoa ngoai)
	CONSTRAINT F_HS_GT	FOREIGN KEY(MAGIOITINH)	REFERENCES GIOITINH(MAGIOITINH),
	CONSTRAINT FK_HS_DT	FOREIGN KEY(MADANTOC)	REFERENCES DANTOC(MADANTOC),
	CONSTRAINT F_HS_TG	FOREIGN KEY(MATONGIAO)	REFERENCES TONGIAO(MATONGIAO),
	CONSTRAINT F_HS_NNC	FOREIGN KEY(MADOITUONG)	REFERENCES DOITUONG(MADOITUONG),
	CONSTRAINT F_HS_NNM	FOREIGN KEY(MAPHUHUYNH)	REFERENCES PHUHUYNH(MAPHUHUYNH)
)
SET DATEFORMAT DMY
INSERT INTO HOCSINH VALUES('HS01',N'TRẦN TẤN ĐẠT',1,'03/10/1996','BHH','DT01','TG01','DTG01','PH01')
INSERT INTO HOCSINH VALUES('HS02',N'PHAN MINH VŨ',1,'03/10/1996','BHH','DT01','TG01','DTG01','PH01')
INSERT INTO HOCSINH VALUES('HS03',N'NGUYỄN PHẠM TUÂN ',1,'03/10/1996','BHH','DT01','TG01','DTG01','PH01')
INSERT INTO HOCSINH VALUES('HS04',N'HOÀNG BÁ HIỆP',1,'03/10/1996','BHH','DT01','TG01','DTG01','PH01')
INSERT INTO HOCSINH VALUES('HS05',N'TRẦN HOÀNG KHƯƠNG',1,'03/10/1996','BHH','DT01','TG01','DTG01','PH01')
-----------------------------------------------------------------------------------------------------------------------------------------------------
/* OK */
CREATE TABLE PHANLOP
(
	STT			INT IDENTITY(1,1)	NOT NULL PRIMARY KEY,
	MANAMHOC	VARCHAR (10)		NOT NULL,
	MALOP		VARCHAR (10)		NOT NULL,
	MAHOCSINH	VARCHAR (10)		NOT NULL,

	--- Khóa ngoại
	CONSTRAINT FK_PL_NAMHOC	FOREIGN KEY(MANAMHOC)	REFERENCES NAMHOC(MANAMHOC),
	CONSTRAINT FK_PL_LOP	FOREIGN KEY(MALOP)		REFERENCES LOP(MALOP),
	CONSTRAINT FK_PL_HS		FOREIGN KEY(MAHOCSINH)	REFERENCES HOCSINH(MAHOCSINH)
)
INSERT INTO PHANLOP(MANAMHOC, MALOP, MAHOCSINH) VALUES('NH1415','14151001','HS01')
INSERT INTO PHANLOP(MANAMHOC, MALOP, MAHOCSINH) VALUES('NH1415','14151001','HS02')
INSERT INTO PHANLOP(MANAMHOC, MALOP, MAHOCSINH) VALUES('NH1415','14151001','HS03')
INSERT INTO PHANLOP(MANAMHOC, MALOP, MAHOCSINH) VALUES('NH1415','14151002','HS04')
INSERT INTO PHANLOP(MANAMHOC, MALOP, MAHOCSINH) VALUES('NH1516','15161001','HS05')
-----------------------------------------------------------------------------------------------------------------------------------------------------
/* OK */
CREATE TABLE PHANCONG
(
	STT			INT					IDENTITY	PRIMARY KEY,
	MANAMHOC	VARCHAR (10)		NOT NULL,
	MALOP		VARCHAR (10)		NOT NULL,
	MAMONHOC	VARCHAR (10)		NOT NULL,
	MAGIAOVIEN	VARCHAR (10)		NOT NULL,
	
	-- (4 khoa ngoai)
	CONSTRAINT Fk_PHANCONG_NAMHOC	FOREIGN KEY(MANAMHOC)	REFERENCES NAMHOC(MANAMHOC),
	CONSTRAINT P_PC_LOP				FOREIGN KEY(MALOP)		REFERENCES LOP(MALOP),
	CONSTRAINT P_PC_MONHOC			FOREIGN KEY(MAMONHOC)	REFERENCES MONHOC(MAMONHOC),
	CONSTRAINT P_PC_GIAOVIEN		FOREIGN KEY(MAGIAOVIEN)	REFERENCES GIAOVIEN(MAGIAOVIEN)
)
-----------------------------------------------------------------------------------------------------------------------------------------------------
--/* OK */
CREATE TABLE DIEMSO
(
	MAHOCSINH				VARCHAR (10)		NOT NULL,
	MAMONHOC				VARCHAR (10)		NOT NULL,
	MAHOCKY					VARCHAR (10)		NOT NULL,
	MALOP					VARCHAR (10)		NOT NULL,
	DIEMKTMIENG				FLOAT				,
	DIEMKT15PH				FLOAT				,
	DIEMKT45P				FLOAT				,
	DIEMTHICUOIKY			FLOAT				,
	DTB						FLOAT				,
	PRIMARY KEY(MAHOCSINH, MAMONHOC, MAHOCKY, MALOP),
	-- (4 khoa ngoai)
	CONSTRAINT F_DIEM_HS	FOREIGN KEY(MAHOCSINH)	REFERENCES HOCSINH(MAHOCSINH),
	CONSTRAINT F_DIEM_MH	FOREIGN KEY(MAMONHOC)	REFERENCES MONHOC(MAMONHOC),
	CONSTRAINT F_DIEM_LOP	FOREIGN KEY(MALOP)		REFERENCES LOP(MALOP)
)

<<<<<<< HEAD
=======


---- lọc ra danh sách ai đã có điểm
INSERT INTO DIEMSO(MaHocSinh, MaMonHoc, MaHocKy, MaLop)
SELECT distinct pl.MaHocSinh, MaHocKy, MaMonHoc, pl.MaLop
FROM PHANLOP pl LEFT JOIN DIEMSO bd ON pl.MaLop = bd.MaLop 
WHERE pl.MaLop = '' AND pl.MaHocSinh NOT IN (select MaHocSinh FROM DIEMSO 
WHERE MaLop = '' AND MaHocKy = '' AND MaMonHoc = '')

SELECT bd.*, pl.STT, hs.HOTENHOCSINH
FROM DIEMSO bd, PHANLOP pl, HOCSINH hs WHERE hs.MaHocSinh = pl.MaHocSinh AND bd.MaHocSinh = pl.MaHocSinh AND pl.MaLop = bd.MaLop

Use QLHS_HCMUS_23
INSERT INTO BANGDIEM(MaHocSinh,MaHocKy,MaMonHoc,MaLop)
SELECT distinct pl.MaHocSinh, MaHocKy, bd.MaMonHoc, pl.MaLop
FROM PHANLOP pl LEFT JOIN BANGDIEM bd ON pl.MaLop = bd.MaLop 
LEFT JOIN MONHOC mh ON mh.MaMonHoc = bd.MaMonHoc
WHERE pl.MaLop = '10A01NH1011' AND pl.MaHocSinh NOT IN (select MaHocSinh FROM BANGDIEM
WHERE MaLop = '10A01NH1011' AND MaHocKy = '1' AND MaMonHoc = 'cnghe')

use DB_QLHOCSINH_THPT

SELECT bd.MAHOCSINH, hs.HOTENHOCSINH
FROM DIEMSO bd, PHANLOP pl, HOCSINH hs
WHERE hs.MaHocSinh = pl.MaHocSinh AND bd.MaHocSinh = pl.MaHocSinh AND pl.MaLop = bd.MaLop

<<<<<<< HEAD
SELECT hs.MAHOCSINH, hs.HOTENHOCSINH, (CASE When hs.MAGIOITINH = '1' THEn 'NAM' else N'Nữ' END) AS MAGIOITINH, hs.NGAYSINH, hs.NOISINH, dt.TENDANTOC, tg.TENTONGIAO, dtg.TENDOITUONG, ph.HOTENPHUHUYNH
from HOCSINH hs, PHUHUYNH ph, DANTOC dt, TONGIAO tg, DOITUONG dtg
where hs.MAPHUHUYNH=ph.MAPHUHUYNH and hs.MADANTOC=dt.MADANTOC and hs.MATONGIAO=tg.MATONGIAO and hs.MADOITUONG=dtg.MADOITUONG  
AND hs.MAHOCSINH in(select MAHOCSINH from PHANLOP  where MALOP = '14151001' )

SELECT HOCSINH.MAHOCSINH, HOCSINH.HOTENHOCSINH, (CASE When HOCSINH.MAGIOITINH = '1' THEn 'NAM' else N'Nữ' END) AS MAGIOITINH, HOCSINH.NGAYSINH, HOCSINH.NOISINH, DANTOC.TENDANTOC, TONGIAO.TENTONGIAO, DOITUONG.TENDOITUONG, PHUHUYNH.HOTENPHUHUYNH from HOCSINH , PHUHUYNH , DANTOC , TONGIAO , DOITUONG where HOCSINH.MAPHUHUYNH=PHUHUYNH.MAPHUHUYNH and HOCSINH.MADANTOC=DANTOC.MADANTOC and HOCSINH.MATONGIAO=TONGIAO.MATONGIAO and HOCSINH.MADOITUONG=DOITUONG.MADOITUONG  AND HOCSINH.MAHOCSINH in(select MAHOCSINH from PHANLOP  where MALOP='14151001')
select hs.MAHOCSINH, hs.HOTENHOCSINH, (CASE When hs.MAGIOITINH = '1' THEn 'NAM' else N'Nữ' END) AS MAGIOITINH, hs.NGAYSINH, hs.NOISINH, hs.MADANTOC, hs.MATONGIAO, hs.MADOITUONG, hs.MAPHUHUYNH
from HOCSINH hs
where hs.MAHOCSINH in (select MAHOCSINH from PHANLOP)


select * from HOCSINH where MAHOCSINH In (select MAHOCSINH from PHANLOP where MALOP ='14151001' )


select MALOP, TENLOP, KL.TENKHOILOP, NH.TENNAMHOC, SISO, GV.TENGIAOVIEN
from LOP , NAMHOC NH, GIAOVIEN GV, KHOILOP KL
where LOP.MAGIAOVIENCHUNHIEM = GV.MAGIAOVIEN
AND LOP.MAKHOI = KL.MAKHOI
AND LOP.MANAMHOC = NH.MANAMHOC AND Malop = '14151001'
=======
SELECT bd.*, m.HeSo FROM MONHOC m LEFT JOIN DIEMSO bd ON m.MaMonHoc = bd.MaMonHoc
>>>>>>> origin/master
>>>>>>> origin/master
